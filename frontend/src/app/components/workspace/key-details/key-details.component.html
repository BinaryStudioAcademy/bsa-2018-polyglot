<div class="key-details mt-1 mb-1" *ngIf="isEmpty">
	<mat-card class="no-languages-div">
	<p>No languages</p>
	</mat-card>
</div>
<div *ngIf="!isLoad && !isEmpty" class="spinner key-details my-1 px-0 grow-1 mr-0 ml-1">
		<mat-spinner></mat-spinner>
</div>
<mat-card *ngIf="isLoad" class="key-details my-1 px-0 grow-1 mr-0 ml-1">
	<div>
		<div *ngFor="let t of keyDetails.translations; let i = index;" class="comments-container">
				<mat-accordion class="example-headers-align">
						<mat-expansion-panel [(disabled)]="isDisabled" [expanded]="expandedArray[i].isOpened" (opened)="setStep(i)" hideToggle>
						  <mat-expansion-panel-header class="header-translation" *ngIf = "!(expandedArray[i].isOpened)" >
								  <mat-panel-title class="mat-panel-title">
									  <p>{{t.languageName}}</p>
								  </mat-panel-title>
								  <mat-panel-description class="mat-panel-description">
								  	<p *ngIf = "t.translationValue">{{t.translationValue}}</p>
								  	<p *ngIf = "!t.translationValue" class="none-translation">Click here to start translating...
									</p>
								</mat-panel-description>
								<button mat-icon-button [matMenuTriggerFor]="optionalMenu" matTooltip="Suggest optional translation" matTooltipPosition="after" color="primary" class="optional-btn" (mouseenter)="toggleDisable()" (mouseleave)="toggleDisable()">
									<mat-icon style="font-size: 22px">translate</mat-icon>
								</button>
								<mat-menu #optionalMenu="matMenu" yPosition="below" xPosition="before" [overlapTrigger]="false" class="no-menu-scroll">
									<div class="optional-container" (click)="$event.preventDefault(); $event.stopPropagation();">
										<mat-form-field class="textarea-translation">
											<textarea matInput cdkTextareaAutosize
												cdkAutosizeMinRows="1"
												placeholder="Write here your optional translation"
												cdkAutosizeMaxRows="10"></textarea>
										</mat-form-field>
										<button mat-raised-button color="primary">Suggest</button>
									</div>
								</mat-menu>
							</mat-expansion-panel-header>
						   <div >
								<mat-form-field class="textarea-translation">
										<mat-label class="language-label">{{t.languageName}}</mat-label>
										<textarea matInput
												[(ngModel)]="t.translationValue"
												  cdkTextareaAutosize
													  cdkAutosizeMinRows="2"
													  placeholder="Write here to start translating"
													  cdkAutosizeMaxRows="10"></textarea>
								</mat-form-field>
								<div [hidden]="!someOneTranslating" class="state-container">
										<span *ngFor="let u of editingUsers">
											<a [routerLink]="['/']" [routerLinkActive]="'active'">
												{{u.fullName}}
											</a>
											,&nbsp;
										</span>
										translating this line right now
								</div>
								<div class="button-translation">
									<button mat-raised-button color="primary"  (click)="onSave(i, t)">Save</button>
									<button mat-raised-button color="warn"  (click)="onClose(i, t)">Close</button>
								</div>

						  </div>
						</mat-expansion-panel>
				</mat-accordion>
		</div>
	</div>
</mat-card>

<mat-card class="my-1 ml-1 px-1 grow-1 translations-details">
	<mat-tab-group flex>
		<mat-tab label="Detail">
			<ng-template mat-tab-label>
				<mat-icon class="icon-size" matTooltip="Detail" matTooltipPosition="above">details</mat-icon>
			</ng-template>
			<app-tab-detail [(keyDetails)]="keyDetails"></app-tab-detail>
		</mat-tab>
		<mat-tab label="History">
			<ng-template mat-tab-label>
				<mat-icon class="icon-size" matTooltip="History" matTooltipPosition="above">history</mat-icon>
			</ng-template>
			<!-- <app-tab-history></app-tab-history> -->
			<app-tab-history *ngIf="isLoad" [(keyDetails)]="keyDetails"></app-tab-history>
		</mat-tab>
		<mat-tab label="Comment">
			<ng-template mat-tab-label>
				<mat-icon class="icon-size" matTooltip="Comment" matTooltipPosition="above">comment</mat-icon>
			</ng-template>
			<app-tab-comments [(comments)] = "comments"></app-tab-comments>
			<!-- <app-tab-comments *ngIf="keyDetails" [(keyDetails)] = "keyDetails"></app-tab-comments> -->

		</mat-tab>
		<mat-tab label="O_Translation">
			<ng-template mat-tab-label>
				<mat-icon class="icon-size" matTooltip="Optional Translation" matTooltipPosition="above">translate</mat-icon>
			</ng-template>
		</mat-tab>
		<mat-tab label="M_Translation">
			<ng-template mat-tab-label>
				<mat-icon class="icon-size" matTooltip="Machine Translation" matTooltipPosition="above">g_translate</mat-icon>
			</ng-template>
		</mat-tab>
	</mat-tab-group>
</mat-card>
